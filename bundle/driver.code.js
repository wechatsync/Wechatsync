window.driver = "let modules =/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (immutable) */ __webpack_exports__[\"getDriver\"] = getDriver;\n/* harmony export (immutable) */ __webpack_exports__[\"getPublicAccounts\"] = getPublicAccounts;\n/* harmony export (immutable) */ __webpack_exports__[\"getMeta\"] = getMeta;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__JianShuDriver__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__ZhiHuDriver__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__WordpressDriver__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__ToutiaoDriver__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Weibo__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Segmentfault__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__Juejin__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__CSDN__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__Cnblog__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__WeixinDriver__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__YiDian__ = __webpack_require__(11);\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction getDriver(account) {\r\n  if (account.type == \"wordpress\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_2__WordpressDriver__[\"a\" /* default */](\r\n      account.params.wpUrl,\r\n      account.params.wpUser,\r\n      account.params.wpPwd\r\n    );\r\n  }\r\n\r\n  if (account.type == \"zhihu\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_1__ZhiHuDriver__[\"a\" /* default */]();\r\n  }\r\n\r\n  if (account.type == \"jianshu\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_0__JianShuDriver__[\"a\" /* default */]();\r\n  }\r\n\r\n  if (account.type == \"typecho\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_2__WordpressDriver__[\"a\" /* default */](\r\n      account.params.wpUrl,\r\n      account.params.wpUser,\r\n      account.params.wpPwd,\r\n      true\r\n    );\r\n  }\r\n\r\n  if (account.type == \"toutiao\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_3__ToutiaoDriver__[\"a\" /* default */]();\r\n  }\r\n\r\n  if (account.type == \"weibo\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_4__Weibo__[\"a\" /* default */]();\r\n  }\r\n\r\n  if (account.type == \"segmentfault\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_5__Segmentfault__[\"a\" /* default */](account);\r\n  }\r\n\r\n  if (account.type == \"juejin\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_6__Juejin__[\"a\" /* default */](account);\r\n  }\r\n\r\n  if (account.type == \"csdn\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_7__CSDN__[\"a\" /* default */](account);\r\n  }\r\n\r\n  if (account.type == \"cnblog\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_8__Cnblog__[\"a\" /* default */](account);\r\n  }\r\n  if (account.type == \"weixin\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_9__WeixinDriver__[\"a\" /* default */](account);\r\n  }\r\n\r\n  if(account.type == \"yidian\") {\r\n    return new __WEBPACK_IMPORTED_MODULE_10__YiDian__[\"a\" /* default */](account);\r\n  }\r\n\r\n  throw Error(\"not supprt account type\");\r\n}\r\n\r\nasync function getPublicAccounts() {\r\n  console.log(\"getPublicAccounts\");\r\n  var drivers = [\r\n    new __WEBPACK_IMPORTED_MODULE_5__Segmentfault__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_7__CSDN__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_6__Juejin__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_8__Cnblog__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_4__Weibo__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_1__ZhiHuDriver__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_0__JianShuDriver__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_3__ToutiaoDriver__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_9__WeixinDriver__[\"a\" /* default */](),\r\n    new __WEBPACK_IMPORTED_MODULE_10__YiDian__[\"a\" /* default */]()\r\n  ];\r\n  var users = [];\r\n  for (let index = 0; index < drivers.length; index++) {\r\n    const driver = drivers[index];\r\n    try {\r\n      var user = await driver.getMetaData();\r\n      users.push(user);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  return users;\r\n}\r\n\r\nfunction getMeta () {\r\n  return {\r\n    version: '0.0.6',\r\n    versionNumber: 6,\r\n    log: ''\r\n  }\r\n}\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar NoteVersionCaches = {};\r\nvar defaultNoteBookId;\r\n\r\nclass JianShuDriver {\r\n  constructor() {\r\n    this.name = \"jianshu\";\r\n    // chrome.cookies.getAll({ domain: \"zhihu.com\"},  function(cookies){\r\n    //     console.log(cookies)\r\n    // })\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.ajax({\r\n      url: \"https://www.jianshu.com/settings/basic.json\"\r\n    });\r\n    var notebooks = await $.get(\"https://www.jianshu.com/author/notebooks\");\r\n    // console.log(res);\r\n    // https://upload.jianshu.io/users/upload_avatars/12192974/d02c5033-7f82-458f-9b3e-f4c4dbaa1221?imageMogr2/auto-orient/strip|imageView2/1/w/96/h/96\r\n    return {\r\n      uid: res.data.avatar.split(\"/\")[5],\r\n      title: res.data.nickname,\r\n      avatar: res.data.avatar,\r\n      type: \"jianshu\",\r\n      displayName: \"简书\",\r\n      supportTypes: [\"html\"],\r\n      home: \"https://www.jianshu.com/settings/basic\",\r\n      icon: \"https://www.jianshu.com/favicon.ico\",\r\n      notebooks: notebooks\r\n    };\r\n  }\r\n\r\n  async addPost(post) {\r\n    var notebooks = await $.get(\"https://www.jianshu.com/author/notebooks\");\r\n    var firstNoteBook = notebooks[0];\r\n    defaultNoteBookId = firstNoteBook.id;\r\n    var res = await $.ajax({\r\n      url: \"https://www.jianshu.com/author/notes\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      headers: {\r\n        accept: \"application/json\"\r\n      },\r\n      contentType: \"application/json\",\r\n      data: JSON.stringify({\r\n        at_bottom: false,\r\n        notebook_id: firstNoteBook.id,\r\n        title: post.post_title\r\n      })\r\n    });\r\n    console.log(res);\r\n    return {\r\n      status: \"success\",\r\n      post_id: res.id,\r\n      notebook_id: firstNoteBook.id\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    var cacheVerions = NoteVersionCaches[post_id];\r\n    var notebook_id = post.notebook_id ? post.notebook_id : defaultNoteBookId;\r\n\r\n    if (!cacheVerions) {\r\n      var bookNotes = await $.get(\r\n        \"https://www.jianshu.com/author/notebooks/\" + notebook_id + \"/notes\"\r\n      );\r\n      var currentNote = bookNotes.filter(t => {\r\n        return t.id == post_id;\r\n      })[0];\r\n\r\n      console.log(post_id, bookNotes);\r\n      NoteVersionCaches[post_id] = currentNote.autosave_control;\r\n      NoteVersionCaches[post_id]++;\r\n      cacheVerions = NoteVersionCaches[post_id];\r\n    } else {\r\n      NoteVersionCaches[post_id]++;\r\n      cacheVerions = NoteVersionCaches[post_id];\r\n    }\r\n\r\n    console.log(\"currentNote\", cacheVerions);\r\n    var requestData = {\r\n      autosave_control: cacheVerions\r\n    };\r\n\r\n    if (post.post_content) {\r\n      requestData.content = post.post_content;\r\n    }\r\n\r\n    if (post_id) {\r\n      requestData.id = post_id;\r\n    }\r\n\r\n    if (post.post_title) {\r\n      requestData.title = post.post_title;\r\n    }\r\n\r\n    // https://www.jianshu.com/author/notebooks/108908/notes\r\n    var res = await $.ajax({\r\n      url: \"https://www.jianshu.com/author/notes/\" + post_id,\r\n      type: \"PUT\",\r\n      dataType: \"JSON\",\r\n      contentType: \"application/json\",\r\n      headers: {\r\n        accept: \"application/json\"\r\n      },\r\n      data: JSON.stringify(requestData)\r\n    });\r\n\r\n    return {\r\n      status: \"success\",\r\n      notebook_id: notebook_id,\r\n      post_id: post_id,\r\n      draftLink:\r\n        \"https://www.jianshu.com/writer#/notebooks/\" +\r\n        notebook_id +\r\n        \"/notes/\" +\r\n        post_id\r\n    };\r\n  }\r\n\r\n  async uploadFile(file) {\r\n    var src = file.src;\r\n    try {\r\n      // jianshu not support webp\r\n      if (src.indexOf(\"xitu.io\") > -1) {\r\n        src = src.replace(\"webp\", \"png\");\r\n      }\r\n\r\n      var res = await $.ajax({\r\n        url: \"https://www.jianshu.com/upload_images/fetch\",\r\n        type: \"POST\",\r\n        contentType: \"application/json\",\r\n        xhrFields: {\r\n          withCredentials: true\r\n        },\r\n        headers: {\r\n          accept: \"application/json\"\r\n        },\r\n        data: JSON.stringify({\r\n          url: src\r\n        })\r\n      });\r\n\r\n      // http only\r\n      console.log(\"uploadFile\", res);\r\n      return [res];\r\n    } catch (e) {\r\n      console.log(\"JianShuDriver.uploadFile\", e);\r\n      var error = e.responseJSON.error[0].message;\r\n      throw new Error(error);\r\n    }\r\n  }\r\n\r\n  async preEditPost(post) {\r\n    var div = $(\"<div>\");\r\n    $(\"body\").append(div);\r\n    div.html(post.content);\r\n    var doc = div;\r\n    var processEmptyLine = function(idx, el) {\r\n      var $obj = $(this);\r\n      var originalText = $obj.text();\r\n      var img = $obj.find(\"img\");\r\n      var brs = $obj.find(\"br\");\r\n      if (originalText == \"\") {\r\n        (function() {\r\n          if (img.length) return;\r\n          if (!brs.length) return;\r\n          $obj.remove();\r\n        })();\r\n      }\r\n\r\n      // try to replace as h2;\r\n      var strongTag = $obj.find(\"strong\").eq(0);\r\n      var childStrongText = strongTag.text();\r\n      if (originalText == childStrongText) {\r\n        var strongSize = null;\r\n        var tagStart = strongTag;\r\n        var align = null;\r\n        for (let index = 0; index < 4; index++) {\r\n          var fontSize = tagStart.css(\"font-size\");\r\n          var textAlign = tagStart.css(\"text-align\");\r\n          if (fontSize) {\r\n            strongSize = fontSize;\r\n          }\r\n          if (textAlign) {\r\n            align = textAlign;\r\n          }\r\n          if (align && strongSize) break;\r\n          if (tagStart == $obj) {\r\n            console.log(\"near top\");\r\n            break;\r\n          }\r\n          tagStart = tagStart.parent();\r\n        }\r\n        if (strongSize) {\r\n          var theFontSize = parseInt(strongSize);\r\n          if (theFontSize > 17 && align == \"center\") {\r\n            var newTag = $(\"<h2></h2>\").append($obj.html());\r\n            $obj.after(newTag).remove();\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    // remove empty break line\r\n    doc.find(\"p\").each(processEmptyLine);\r\n    doc.find(\"section\").each(processEmptyLine);\r\n\r\n    var processBr = function(idx, el) {\r\n      var $obj = $(this);\r\n      if (!$obj.next().length) {\r\n        $obj.remove();\r\n      }\r\n    };\r\n    doc.find(\"br\").each(processBr);\r\n    // table {\r\n    //     margin-bottom: 10px;\r\n    //     border-collapse: collapse;\r\n    //     display: table;\r\n    //     width: 100%!important;\r\n    // }\r\n    // td, th {\r\n    //     word-wrap: break-word;\r\n    //     word-break: break-all;\r\n    //     padding: 5px 10px;\r\n    //     border: 1px solid #DDD;\r\n    // }\r\n\r\n    // console.log('found table', doc.find('table'))\r\n    var tempDoc = $(\"<div>\").append(doc.clone());\r\n    post.content =\r\n      tempDoc.children(\"div\").length == 1\r\n        ? tempDoc.children(\"div\").html()\r\n        : tempDoc.html();\r\n    // div.remove();\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = JianShuDriver;\n\r\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nfunction escapeHtml(text) {\r\n  return text\r\n    .replace(/&/g, \"&amp;\")\r\n    .replace(/</g, \"&lt;\")\r\n    .replace(/>/g, \"&gt;\")\r\n    .replace(/\"/g, \"&quot;\")\r\n    .replace(/'/g, \"&#039;\");\r\n}\r\n\r\nfunction getChildren(obj, count) {\r\n  count++;\r\n  if (count > 4) return null;\r\n  if (obj.children().length > 1) return obj;\r\n  return getChildren(obj.children().eq(0), count);\r\n}\r\n\r\nfunction CodeBlockToPlainTextOther(pre) {\r\n  var text = [];\r\n  var minSub = getChildren(pre, 0);\r\n  var lines = minSub.children();\r\n  for (let index = 0; index < lines.length; index++) {\r\n    const element = lines.eq(index);\r\n    const codeStr = element.text();\r\n    text.push(\"<code>\" + escapeHtml(codeStr) + \"</code>\");\r\n  }\r\n  return text.join(\"\\n\");\r\n}\r\n\r\nfunction CodeBlockToPlainText(pre) {\r\n  var text = [];\r\n  var minSub = getChildren(pre, 0);\r\n  var lines = pre.find(\"code\");\r\n  if (lines.length > 1) {\r\n    return CodeBlockToPlainTextOther(pre);\r\n  }\r\n\r\n  for (let index = 0; index < lines.length; index++) {\r\n    const element = lines.eq(index);\r\n    const codeStr = element[0].innerText;\r\n    console.log(\"codeStr\", codeStr);\r\n    var codeLines = codeStr.split(\"\\n\");\r\n    codeLines.forEach(codeLine => {\r\n      text.push(\"<code>\" + escapeHtml(codeLine) + \"</code>\");\r\n    });\r\n  }\r\n  return text.join(\"\\n\");\r\n}\r\n\r\nclass ZhiHuDriver {\r\n  constructor() {\r\n    this.skipReadImage = true;\r\n    this.version = \"0.0.1\";\r\n    this.name = \"zhihu\";\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.ajax({\r\n      url:\r\n        \"https://www.zhihu.com/api/v4/me?include=account_status%2Cis_bind_phone%2Cis_force_renamed%2Cemail%2Crenamed_fullname\"\r\n    });\r\n    // console.log(res);\r\n    return {\r\n      uid: res.uid,\r\n      title: res.name,\r\n      avatar: res.avatar_url,\r\n      supportTypes: [\"html\"],\r\n      type: \"zhihu\",\r\n      displayName: \"知乎\",\r\n      home: \"https://www.zhihu.com/settings/account\",\r\n      icon: \"https://static.zhihu.com/static/favicon.ico\"\r\n    };\r\n  }\r\n\r\n  async addPost(post) {\r\n    var res = await $.ajax({\r\n      url: \"https://zhuanlan.zhihu.com/api/articles/drafts\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      contentType: \"application/json\",\r\n      data: JSON.stringify({\r\n        title: post.post_title\r\n        // content: post.post_content\r\n      })\r\n    });\r\n    console.log(res);\r\n    return {\r\n      status: \"success\",\r\n      post_id: res.id\r\n    };\r\n    //\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    console.log(\"editPost\", post.post_thumbnail);\r\n    var res = await $.ajax({\r\n      url: \"https://zhuanlan.zhihu.com/api/articles/\" + post_id + \"/draft\",\r\n      type: \"PATCH\",\r\n      contentType: \"application/json\",\r\n      data: JSON.stringify({\r\n        title: post.post_title,\r\n        content: post.post_content,\r\n        isTitleImageFullScreen: false,\r\n        titleImage: \"https://pic1.zhimg.com/\" + post.post_thumbnail + \".png\"\r\n      })\r\n    });\r\n\r\n    return {\r\n      status: \"success\",\r\n      post_id: post_id,\r\n      draftLink: \"https://zhuanlan.zhihu.com/p/\" + post_id + \"/edit\"\r\n    };\r\n    // https://zhuanlan.zhihu.com/api/articles/68769713/draft\r\n  }\r\n\r\n  untiImageDone(image_id) {\r\n    return new Promise((resolve, reject) => {\r\n      (async function loop() {\r\n        var imgDetail = await $.ajax({\r\n          url: \"https://api.zhihu.com/images/\" + image_id,\r\n          type: \"GET\"\r\n        });\r\n        if (imgDetail.status != \"processing\") {\r\n          resolve(imgDetail);\r\n        } else {\r\n          setTimeout(loop, 300);\r\n        }\r\n      })();\r\n    });\r\n  }\r\n\r\n\r\n  async uploadFile(file) {\r\n    var src = file.src;\r\n    var res = await $.ajax({\r\n      url: \"https://zhuanlan.zhihu.com/api/uploaded_images\",\r\n      type: \"POST\",\r\n      headers: {\r\n        accept: \"*/*\",\r\n        'x-requested-with': 'fetch'\r\n      },\r\n      data: {\r\n        url: src,\r\n        source: 'article',\r\n      }\r\n    });\r\n\r\n    return [\r\n      {\r\n        id: res.hash,\r\n        object_key: res.hash,\r\n        url: res.src\r\n      }\r\n    ];\r\n  }\r\n\r\n  async uploadFileRaw(file) {\r\n    var fileResp = await $.ajax({\r\n      url: \"https://api.zhihu.com/images\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      contentType: \"application/json\",\r\n      data: JSON.stringify({\r\n        image_hash: md5(file.bits),\r\n        source: \"article\"\r\n      })\r\n    });\r\n\r\n    var upload_file = fileResp.upload_file;\r\n    if (fileResp.upload_file.state == 1) {\r\n      var imgDetail = await this.untiImageDone(upload_file.image_id);\r\n      console.log(\"imgDetail\", imgDetail);\r\n      upload_file.object_key = imgDetail.original_hash;\r\n    } else {\r\n      var token = fileResp.upload_token;\r\n      let client = new OSS({\r\n        endpoint: \"https://zhihu-pics-upload.zhimg.com\",\r\n        accessKeyId: token.access_id,\r\n        accessKeySecret: token.access_key,\r\n        stsToken: token.access_token,\r\n        cname: true,\r\n        bucket: \"zhihu-pics\"\r\n      });\r\n      var finalUrl = await client.put(\r\n        upload_file.object_key,\r\n        new Blob([file.bits])\r\n      );\r\n      console.log(client, finalUrl);\r\n    }\r\n\r\n    console.log(file, fileResp);\r\n    return [\r\n      {\r\n        id: upload_file.object_key,\r\n        object_key: upload_file.object_key,\r\n        url: \"https://pic1.zhimg.com/80/\" + upload_file.object_key + \"_hd.png\"\r\n      }\r\n    ];\r\n  }\r\n\r\n  async preEditPost(post) {\r\n    var div = $(\"<div>\");\r\n    $(\"body\").append(div);\r\n\r\n    // post.content = post.content.replace(/\\>\\s+\\</g,'');\r\n\r\n    div.html(post.content);\r\n\r\n    // var org = $(post.content);\r\n    // var doc = $('<div>').append(org.clone());\r\n    var doc = div;\r\n    var pres = doc.find(\"pre\");\r\n    console.log(\"find code blocks\", pres.length, post);\r\n    for (let mindex = 0; mindex < pres.length; mindex++) {\r\n      const pre = pres.eq(mindex);\r\n      try {\r\n        var newHtml = CodeBlockToPlainText(pre, 0);\r\n        if (newHtml) {\r\n          console.log(newHtml);\r\n          pre.html(newHtml);\r\n        }\r\n      } catch (e) {}\r\n    }\r\n\r\n    var processEmptyLine = function(idx, el) {\r\n      var $obj = $(this);\r\n      var originalText = $obj.text();\r\n      var img = $obj.find(\"img\");\r\n      var brs = $obj.find(\"br\");\r\n      if (originalText == \"\") {\r\n        (function() {\r\n          if (img.length) return;\r\n          if (!brs.length) return;\r\n          $obj.remove();\r\n        })();\r\n      }\r\n\r\n      // try to replace as h2;\r\n      var strongTag = $obj.find(\"strong\").eq(0);\r\n      var childStrongText = strongTag.text();\r\n      if (originalText == childStrongText) {\r\n        var strongSize = null;\r\n        var tagStart = strongTag;\r\n        var align = null;\r\n        for (let index = 0; index < 4; index++) {\r\n          var fontSize = tagStart.css(\"font-size\");\r\n          var textAlign = tagStart.css(\"text-align\");\r\n          if (fontSize) {\r\n            strongSize = fontSize;\r\n          }\r\n          if (textAlign) {\r\n            align = textAlign;\r\n          }\r\n          if (align && strongSize) break;\r\n          if (tagStart == $obj) {\r\n            console.log(\"near top\");\r\n            break;\r\n          }\r\n          tagStart = tagStart.parent();\r\n        }\r\n        if (strongSize) {\r\n          var theFontSize = parseInt(strongSize);\r\n          if (theFontSize > 17 && align == \"center\") {\r\n            var newTag = $(\"<h2></h2>\").append($obj.html());\r\n            $obj.after(newTag).remove();\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    // remove empty break line\r\n    doc.find(\"p\").each(processEmptyLine);\r\n    doc.find(\"section\").each(processEmptyLine);\r\n\r\n    var processBr = function(idx, el) {\r\n      var $obj = $(this);\r\n      if (!$obj.next().length) {\r\n        $obj.remove();\r\n      }\r\n    };\r\n    doc.find(\"br\").each(processBr);\r\n    // table {\r\n    //     margin-bottom: 10px;\r\n    //     border-collapse: collapse;\r\n    //     display: table;\r\n    //     width: 100%!important;\r\n    // }\r\n    // td, th {\r\n    //     word-wrap: break-word;\r\n    //     word-break: break-all;\r\n    //     padding: 5px 10px;\r\n    //     border: 1px solid #DDD;\r\n    // }\r\n\r\n    // console.log('found table', doc.find('table'))\r\n    var tempDoc = $(\"<div>\").append(doc.clone());\r\n    post.content =\r\n      tempDoc.children(\"div\").length == 1\r\n        ? tempDoc.children(\"div\").html()\r\n        : tempDoc.html();\r\n    // div.remove();\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = ZhiHuDriver;\n\r\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nfunction xmlrpcWrapper(conf) {\r\n  return new Promise((resolve, reject) => {\r\n    $.xmlrpc(conf).then(\r\n      function(response, status, xhr) {\r\n        resolve({\r\n          response,\r\n          status,\r\n          xhr\r\n        });\r\n      },\r\n      function(jqXHR, status, error) {\r\n        reject({\r\n          jqXHR,\r\n          status,\r\n          error\r\n        });\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\nclass WordpressDriver {\r\n  constructor(url, user, pwd, isTypecho) {\r\n    this.url = url;\r\n    this.user = user;\r\n    this.pwd = pwd;\r\n    this.isTypecho = isTypecho;\r\n  }\r\n\r\n  getRPC() {\r\n    var endPoint = this.url + \"/xmlrpc.php\";\r\n    if (this.isTypecho) {\r\n      endPoint = this.url + \"/action/xmlrpc\";\r\n    }\r\n    return endPoint;\r\n  }\r\n\r\n  async getMetaData() {\r\n    var params = [this.user, this.pwd];\r\n    var res = await xmlrpcWrapper({\r\n      url: this.getRPC(),\r\n      methodName: \"wp.getUsersBlogs\",\r\n      params: params\r\n    });\r\n    res.icon = chrome.extension.getURL(\"images/wordpress.ico\");\r\n    return res;\r\n  }\r\n\r\n  addPost(post) {\r\n    if (this.isTypecho) {\r\n      return {\r\n        status: \"success\",\r\n        post_id: \"1\"\r\n      };\r\n    }\r\n\r\n    var params = [0, this.user, this.pwd, post];\r\n    var end = this.url;\r\n    return xmlrpcWrapper({\r\n      url: this.getRPC(),\r\n      methodName: \"wp.newPost\",\r\n      params: params\r\n    });\r\n  }\r\n\r\n  editPost(post_id, post) {\r\n    var params = [0, this.user, this.pwd, post];\r\n    var endpoint = this.getRPC();\r\n    var isTypecho = this.isTypecho;\r\n    if (isTypecho) {\r\n      params.push(false);\r\n      params[3] = {\r\n        title: post[\"post_title\"],\r\n        // text: \"!!!\\n\" + post['post_content'].trim() + \"\\n!!!\",\r\n        description: post[\"post_content\"].trim()\r\n        // markdown: 1\r\n      };\r\n      console.log(\"params\", params);\r\n    } else {\r\n      params[3] = post_id;\r\n      params.push(post);\r\n    }\r\n    return new Promise((resolve, reject) => {\r\n      (async () => {\r\n        try {\r\n          var res = await xmlrpcWrapper({\r\n            url: endpoint,\r\n            methodName: isTypecho ? \"metaWeblog.newPost\" : \"wp.editPost\",\r\n            params: params\r\n          });\r\n      \r\n          res.draftLink = this.url + \"?p=\" + post_id;\r\n          console.log(\"Wordpress\", res);\r\n          resolve(res);\r\n        } catch (e) {\r\n          reject(e);\r\n        }\r\n      })();\r\n    });\r\n  }\r\n\r\n  //  'metaWeblog.getPost' => array($this, 'mwGetPost'),\r\n\r\n  uploadFile(file) {\r\n    if (this.isTypecho) {\r\n      file[\"bytes\"] = file[\"bits\"];\r\n      delete file[\"bits\"];\r\n    }\r\n    var params = [0, this.user, this.pwd, file];\r\n\r\n    var end = this.url;\r\n    return $.xmlrpc({\r\n      url: this.getRPC(),\r\n      methodName: \"wp.uploadFile\",\r\n      params: params\r\n    });\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = WordpressDriver;\n\r\n\r\nwindow.WordpressDriver = WordpressDriver;\r\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nclass ToutiaoDriver {\r\n  constructor() {\r\n    this.skipReadImage = true;\r\n    this.name = \"toutiao\";\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.ajax({\r\n      url: \"https://mp.toutiao.com/get_media_info/\"\r\n    });\r\n    // console.log(res);\r\n    return {\r\n      uid: res.data.user.id,\r\n      title: res.data.user.screen_name,\r\n      avatar: res.data.user.https_avatar_url,\r\n      supportTypes: [\"html\"],\r\n      type: \"toutiao\",\r\n      displayName: \"头条\",\r\n      home: \"https://mp.toutiao.com/profile_v3/graphic/publish\",\r\n      icon: \"https://sf1-ttcdn-tos.pstatp.com/obj/ttfe/pgcfe/sz/mp_logo.png\"\r\n    };\r\n  }\r\n\r\n  async addPost(post) {\r\n    return {\r\n      status: \"success\",\r\n      post_id: 0\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    var pgc_feed_covers = [];\r\n    if (post.post_thumbnail_raw && post.post_thumbnail_raw.images) {\r\n      pgc_feed_covers.push({\r\n        id: 0,\r\n        url: post.post_thumbnail_raw.url,\r\n        uri: post.post_thumbnail_raw.images[0].origin_web_uri,\r\n        origin_uri: post.post_thumbnail_raw.images[0].origin_web_uri,\r\n        ic_uri: \"\",\r\n        thumb_width: post.post_thumbnail_raw.images[0].width,\r\n        thumb_height: post.post_thumbnail_raw.images[0].height\r\n      });\r\n    }\r\n\r\n    await $.get(\"https://mp.toutiao.com/profile_v3/graphic/publish\");\r\n\r\n    var res = await $.ajax({\r\n      url:\r\n        \"https://mp.toutiao.com/core/article/edit_article_post/?source=mp&type=article\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      data: {\r\n        title: post.post_title,\r\n        article_ad_type: 3,\r\n        article_type: 0,\r\n        from_diagnosis: 0,\r\n        origin_debut_check_pgc_normal: 0,\r\n        tree_plan_article: 0,\r\n        save: 0,\r\n        pgc_id: 0,\r\n        content: post.post_content,\r\n        pgc_feed_covers: JSON.stringify(pgc_feed_covers)\r\n      }\r\n    });\r\n\r\n    if (!res.data) {\r\n      throw new Error(res.message);\r\n    }\r\n\r\n    return {\r\n      status: \"success\",\r\n      post_id: res.data.pgc_id,\r\n      draftLink:\r\n        \"https://mp.toutiao.com/profile_v3/graphic/publish?pgc_id=\" +\r\n        res.data.pgc_id\r\n    };\r\n  }\r\n\r\n  async uploadFile(file) {\r\n    var src = file.src;\r\n    var res = await $.ajax({\r\n      url: \"https://mp.toutiao.com/tools/catch_picture/\",\r\n      type: \"POST\",\r\n      headers: {\r\n        accept: \"*/*\"\r\n      },\r\n      data: {\r\n        upfile: src,\r\n        version: 2\r\n      }\r\n    });\r\n\r\n    // throw new Error('fuck');\r\n\r\n    if (res.images && !res.images.length) {\r\n      throw new Error('图片上传失败 '+src);\r\n    }\r\n\r\n    // http only\r\n    console.log(\"uploadFile\", res);\r\n    return [res];\r\n  }\r\n\r\n  async preEditPost(post) {\r\n    var div = $(\"<div>\");\r\n    $(\"body\").append(div);\r\n\r\n    div.html(post.content);\r\n\r\n    // var org = $(post.content);\r\n    // var doc = $('<div>').append(org.clone());\r\n    \r\n\r\n\r\n    var doc = div;\r\n    var pres = doc.find(\"a\");\r\n    for (let mindex = 0; mindex < pres.length; mindex++) {\r\n      const pre = pres.eq(mindex);\r\n      try {\r\n        pre.after(pre.html()).remove();\r\n      } catch (e) {}\r\n    }\r\n\r\n    var pres = doc.find(\"iframe\");\r\n    for (let mindex = 0; mindex < pres.length; mindex++) {\r\n      const pre = pres.eq(mindex);\r\n      try {\r\n        pre.remove();\r\n      } catch (e) {}\r\n    }\r\n\r\n    try {\r\n      const images = doc.find('img');\r\n      for (let index = 0; index < images.length; index++) {\r\n        const image = images.eq(index);\r\n        const imgSrc = image.attr('src');\r\n        if(imgSrc && imgSrc.indexOf('.svg') > -1) {\r\n          console.log('remove svg Image');\r\n          image.remove();\r\n        }\r\n      }\r\n      const qqm = doc.find('qqmusic');\r\n      qqm.next().remove();\r\n      qqm.remove();\r\n    } catch (e) {\r\n    }\r\n\r\n    post.content = $(\"<div>\")\r\n      .append(doc.clone())\r\n      .html();\r\n    console.log(\"post\", post);\r\n  }\r\n\r\n  editImg(img, source) {\r\n    img.attr(\"web_uri\", source.images[0].origin_web_uri);\r\n  }\r\n  //   <img class=\"\" src=\"http://p2.pstatp.com/large/pgc-image/bc0a9fc8e595453083d85deb947c3d6e\" data-ic=\"false\" data-ic-uri=\"\" data-height=\"1333\" data-width=\"1000\" image_type=\"1\" web_uri=\"pgc-image/bc0a9fc8e595453083d85deb947c3d6e\" img_width=\"1000\" img_height=\"1333\"></img>\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = ToutiaoDriver;\n\r\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar cacheWeiboUser = null;\r\n// var Readability = require(\"../reader/Readability\");\r\n\r\n// fetch(\"https://card.weibo.com/article/v3/aj/editor/draft/save?uid=1820387812&id=402\", { \"credentials\": \"include\", \"headers\": { \"accept\": \"application/json, text/plain, */*\", \"accept-language\": \"zh-CN,zh;q=0.9\", \"content-type\": \"application/x-www-form-urlencoded\" }, \"referrer\": \"https://card.weibo.com/article/v3/editor\", \"referrerPolicy\": \"no-referrer-when-downgrade\", \"body\": \"id=402&title=aaaaaaaaaaa&updated=2019-10-10%2016%3A06%3A43&subtitle=&type=&status=0&publish_at=&error_msg=&error_code=0&collection=%5B%5D&free_content=&content=%3Cp%20align%3D%22justify%22%3Eaaaaaaaaaaaaa%3C%2Fp%3E&cover=https%3A%2F%2Fwx3.sinaimg.cn%2Flarge%2F6c80e9e4ly1g7t62jq7uzj202s01kdfz.jpg&summary=aaa&writer=&extra=null&is_word=0&article_recommend=%5B%5D&follow_to_read=1&isreward=1&pay_setting=%7B%22ispay%22%3A0%2C%22isvclub%22%3A0%7D&source=0&action=1&save=1\", \"method\": \"POST\", \"mode\": \"cors\" });\r\n\r\nclass WeiboDriver {\r\n  constructor() {\r\n    this.name = \"weibo\";\r\n  }\r\n\r\n  async getMetaData() {\r\n    var html = await $.get(\"https://card.weibo.com/article/v3/editor\");\r\n    var configIndx = html.indexOf(\"$CONFIG\");\r\n    var lastIndex = html.indexOf(\"</script>\", configIndx);\r\n    var configStr = html.substring(configIndx - 12, lastIndex);\r\n\r\n    if (configStr.indexOf(\"CONFIG\") > -1) {\r\n      var res = new Function(configStr + \" return $CONFIG;\")();\r\n      cacheWeiboUser = res;\r\n      return {\r\n        uid: res.uid,\r\n        title: res.nick,\r\n        avatar: res.avatar_large,\r\n        supportTypes: [\"html\"],\r\n        displayName: \"微博\",\r\n        type: \"weibo\",\r\n        home: \"https://card.weibo.com/article/v3/editor\",\r\n        icon: \"https://weibo.com/favicon.ico\"\r\n      };\r\n    } else {\r\n      throw new Error(\"not found\");\r\n    }\r\n  }\r\n\r\n  async addPost(post) {\r\n    var res = await $.post(\r\n      \"https://card.weibo.com/article/v3/aj/editor/draft/create?uid=\" +\r\n        cacheWeiboUser.uid\r\n    );\r\n    if (res.code != 100000) {\r\n      throw new Error(res.msg);\r\n      return;\r\n    }\r\n\r\n    console.log(res);\r\n    var post_id = res.data.id;\r\n\r\n    var res = await $.ajax({\r\n      url:\r\n        \"https://card.weibo.com/article/v3/aj/editor/draft/save?uid=\" +\r\n        cacheWeiboUser.uid +\r\n        \"&id=\" +\r\n        post_id,\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      headers: {\r\n        accept: \"application/json\"\r\n      },\r\n      data:  {\r\n        id: post_id,\r\n        title: post.post_title,\r\n        subtitle: '',\r\n        type: '',\r\n        status: '0',\r\n        publish_at: '',\r\n        error_msg: '',\r\n        error_code: '0',\r\n        collection: '[]',\r\n        free_content: '',\r\n        content: post.post_content,\r\n        cover: '',\r\n        summary: '',\r\n        writer: '',\r\n        extra: 'null',\r\n        is_word: '0',\r\n        article_recommend: '[]',\r\n        follow_to_read: '1',\r\n        isreward: '1',\r\n        pay_setting: '{\"ispay\":0,\"isvclub\":0}',\r\n        source: '0',\r\n        action: '1',\r\n        content_type: '0',\r\n        save: '1' \r\n      }\r\n      // data: {\r\n      //   id: post_id,\r\n      //   title: post.post_title,\r\n      //   status: 0,\r\n      //   error_code: 0,\r\n      //   content: post.post_content,\r\n      //   cover: \"\",\r\n      //   // summary: 'aaaab',\r\n      //   writer: \"\",\r\n      //   is_word: 0,\r\n      //   article_recommend: [],\r\n      //   follow_to_read: 1,\r\n      //   isreward: 1,\r\n      //   pay_setting: JSON.stringify({ ispay: 0, isvclub: 0 }),\r\n      //   source: 0,\r\n      //   action: 1,\r\n      //   save: 1\r\n      // }\r\n    });\r\n    console.log(res);\r\n    return {\r\n      status: \"success\",\r\n      post_id: post_id\r\n    };\r\n  }\r\n\r\n  async preEditPost(post) {\r\n    // var div = $('<div>');\r\n    // $('body').append(div);\r\n    // div.html(post.content);\r\n\r\n    // // var doc = div;\r\n    // // doc.clone()\r\n    // var documentClone = document.cloneNode(true);\r\n    // var article = new Readability(documentClone).parse();\r\n\r\n    // div.remove();\r\n    // console.log(article);\r\n    var rexp = new RegExp(\">[\\ts ]*<\", \"g\");\r\n    var result = post.content.replace(rexp, \"><\");\r\n    post.content = result;\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    var res = await $.ajax({\r\n      url:\r\n        \"https://card.weibo.com/article/v3/aj/editor/draft/save?uid=\" +\r\n        cacheWeiboUser.uid +\r\n        \"&id=\" +\r\n        post_id,\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      headers: {\r\n        accept: \"application/json\"\r\n      },\r\n      data: {\r\n        id: post_id,\r\n        title: post.post_title,\r\n        subtitle: '',\r\n        type: '',\r\n        status: '0',\r\n        publish_at: '',\r\n        error_msg: '',\r\n        error_code: '0',\r\n        collection: '[]',\r\n        free_content: '',\r\n        content: post.post_content,\r\n        cover: post.post_thumbnail_raw ? post.post_thumbnail_raw.url : \"\",\r\n        summary: '',\r\n        writer: '',\r\n        extra: 'null',\r\n        is_word: '0',\r\n        article_recommend: '[]',\r\n        follow_to_read: '1',\r\n        isreward: '1',\r\n        pay_setting: '{\"ispay\":0,\"isvclub\":0}',\r\n        source: '0',\r\n        action: '1',\r\n        content_type: '0',\r\n        save: '1' \r\n      }\r\n      // data: {\r\n      //   id: post_id,\r\n      //   title: post.post_title,\r\n      //   status: 0,\r\n      //   error_code: 0,\r\n      //   content: post.post_content,\r\n      //   cover: post.post_thumbnail_raw ? post.post_thumbnail_raw.url : \"\",\r\n      //   // summary: 'aaaab',\r\n      //   writer: \"\",\r\n      //   is_word: 0,\r\n      //   article_recommend: [],\r\n      //   follow_to_read: 1,\r\n      //   isreward: 1,\r\n      //   pay_setting: JSON.stringify({ ispay: 0, isvclub: 0 }),\r\n      //   source: 0,\r\n      //   action: 1,\r\n      //   save: 1\r\n      // }\r\n    });\r\n    console.log(res);\r\n    return {\r\n      status: \"success\",\r\n      post_id: post_id,\r\n      draftLink: \"https://card.weibo.com/article/v3/editor#/draft/\" + post_id\r\n    };\r\n  }\r\n\r\n  untiImageDone(src) {\r\n    return new Promise((resolve, reject) => {\r\n      (async function loop() {\r\n        var res = await $.ajax({\r\n          url:\r\n            \"https://card.weibo.com/article/v3/aj/editor/plugins/asyncimginfo?uid=\"+cacheWeiboUser.uid,\r\n          type: \"POST\",\r\n          headers: {\r\n            accept: \"*/*\",\r\n            'x-requested-with': 'fetch'\r\n          },\r\n          data: {\r\n            'urls[0]': src\r\n          }\r\n        });\r\n\r\n        var done = res.data[0].task_status_code == 1;\r\n        if (done) {\r\n          resolve(res.data[0]);\r\n        } else {\r\n          setTimeout(loop, 1000);\r\n        }\r\n      })();\r\n    });\r\n  }\r\n\r\n  async uploadFile(file) {\r\n    var src = file.src;\r\n    var res = await $.ajax({\r\n      url:\r\n        \"https://card.weibo.com/article/v3/aj/editor/plugins/asyncuploadimg?uid=\"+cacheWeiboUser.uid,\r\n      type: \"POST\",\r\n      headers: {\r\n        accept: \"*/*\",\r\n        'x-requested-with': 'fetch'\r\n      },\r\n      data: {\r\n        'urls[0]': src\r\n      }\r\n    });\r\n\r\n    // https://card.weibo.com/article/v3/aj/editor/plugins/asyncuploadimg?uid=1820387812\r\n    var imgDetail = await this.untiImageDone(src);\r\n    return [\r\n      {\r\n        id: imgDetail.pid,\r\n        object_key: imgDetail.pid,\r\n        url: imgDetail.url\r\n      }\r\n    ];\r\n  }\r\n  \r\n  async uploadFileOld(file) {\r\n    var blob = new Blob([file.bits]);\r\n    console.log(\"uploadFile\", file, blob);\r\n    var fileResp = await $.ajax({\r\n      url:\r\n        \"https://picupload.weibo.com/interface/pic_upload.php?app=miniblog&s=json&p=1&data=1&url=&markpos=1&logo=0&nick=\",\r\n      type: \"POST\",\r\n      processData: false,\r\n      data: new Blob([file.bits])\r\n    });\r\n\r\n    console.log(file, fileResp);\r\n    return [\r\n      {\r\n        id: fileResp.data.pics.pic_1.pid,\r\n        object_key: fileResp.data.pics.pic_1.pid,\r\n        url:\r\n          \"https://wx3.sinaimg.cn/large/\" +\r\n          fileResp.data.pics.pic_1.pid +\r\n          \".jpg\"\r\n      }\r\n    ];\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = WeiboDriver;\n\r\n\r\n// (async () => {\r\n//     var tester = new WeixinDriver();\r\n//     await tester.getMetaData();\r\n// })();\r\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// https://segmentfault.com/api/article/draft/save?_=63fefd2c2515dd098e0e0a4a33a8ecd4\r\n// type: 1\r\n// url:\r\n// blogId: 0\r\n// isTiming: 0\r\n// created:\r\n// weibo: 0\r\n// license: 0\r\n// tags:\r\n// title: aaaa\r\n// text:\r\n// articleId:\r\n// draftId:\r\n// id:\r\n\r\n// https://segmentfault.com/api/articles/add?_=63fefd2c2515dd098e0e0a4a33a8ecd4\r\n\r\n\r\nvar segIframe = null;\r\nvar abb = {};\r\n\r\nwindow.onmessage = e => {\r\n  var action = JSON.parse(e.data);\r\n  if (action.eventId && abb[action.eventId]) {\r\n    abb[action.eventId](action.err, action.data);\r\n  }\r\n};\r\n\r\nfunction requestFrameMethod(d) {\r\n  return new Promise((resolve, reject) => {\r\n    var evtId = Date.now() + Math.random();\r\n    d.eventId = evtId;\r\n    abb[evtId] = function(err, data) {\r\n      if (err) {\r\n        reject(err);\r\n      } else {\r\n        resolve(data);\r\n      }\r\n    };\r\n\r\n    segIframe.contentWindow.postMessage(JSON.stringify(d), \"*\");\r\n  });\r\n}\r\n\r\nclass Segmentfault {\r\n  constructor() {\r\n    this.name = \"segmentfault\"\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.get(\"https://segmentfault.com/user/settings\");\r\n    var parser = new DOMParser();\r\n    var htmlDoc = parser.parseFromString(res, \"text/html\");\r\n    var link = htmlDoc.getElementsByClassName(\"user-avatar\")[0];\r\n    if (!link) {\r\n      throw Error(\"not found\");\r\n    }\r\n\r\n    var uid = link.href.split(\"/\").pop();\r\n    var avatar = link.style[\"background-image\"]\r\n      .replace('url(\"', \"\")\r\n      .replace('\")', \"\");\r\n    console.log(\r\n      link.href,\r\n      link.style[\"background-image\"].replace('url(\"', \"\").replace('\")', \"\")\r\n    );\r\n\r\n    if (!segIframe) {\r\n      segIframe = document.createElement(\"iframe\");\r\n      segIframe.src = \"https://segmentfault.com/write?freshman=1\";\r\n      document.body.append(segIframe);\r\n    }\r\n\r\n    return {\r\n      uid: uid,\r\n      title: uid,\r\n      avatar: avatar,\r\n      type: \"segmentfault\",\r\n      displayName: \"Segmentfault\",\r\n      supportTypes: [\"markdown\"],\r\n      home: \"https://segmentfault.com/user/draft\",\r\n      icon: \"https://static.segmentfault.com/v-5d8c9d24/global/img/favicon.ico\"\r\n    };\r\n  }\r\n\r\n  async addPost(post) {\r\n    console.log(\"addPost\", segIframe);\r\n\r\n    var data = await requestFrameMethod({\r\n      type: \"sendPost\",\r\n      data: {\r\n        type: 1,\r\n        url: \"\",\r\n        blogId: 0,\r\n        isTiming: 0,\r\n        created: \"\",\r\n        weibo: 0,\r\n        license: 0,\r\n        tags: \"\",\r\n        title: post.post_title,\r\n        text: post.markdown,\r\n        articleId: \"\",\r\n        draftId: \"\",\r\n        id: \"\"\r\n      }\r\n    });\r\n\r\n    console.log(\"data\", data);\r\n    return {\r\n      status: \"success\",\r\n      post_id: data.data\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    return {\r\n      status: \"success\",\r\n      post_id: post_id,\r\n      draftLink: \"https://segmentfault.com/write?draftId=\" + post_id\r\n    };\r\n  }\r\n\r\n  async uploadFile(file) {}\r\n\r\n  async uploadFileByForm($file) {\r\n    var formdata = new FormData();\r\n    formdata.append(\"image\", $file);\r\n    var res = await axios({\r\n      url: \"https://segmentfault.com/img/upload/image\",\r\n      method: \"post\",\r\n      data: formdata,\r\n      headers: { \"Content-Type\": \"multipart/form-data\" }\r\n    });\r\n    var url = \"https://image-static.segmentfault.com/\" + res.data[2];\r\n    return url;\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = Segmentfault;\n\r\n\r\n// (async () => {\r\n//     var tester = new WeixinDriver();\r\n//     await tester.getMetaData();\r\n// })();\r\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar cacheWeiboUser = null;\r\n// var Readability = require(\"../reader/Readability\");\r\n// var axios = require(\"axios\");\r\n\r\nclass Juejin {\r\n  constructor(ac) {\r\n    this.name = \"juejin\";\r\n    this.uploadFile = true;\r\n    this.account = ac;\r\n    this.skipUpload = true;\r\n    console.log(\"Juejin\", 'initliaze', ac, this);\r\n  }\r\n\r\n  async getMetaData() {\r\n    var data = await $.get(\"https://juejin.im/auth\");\r\n    console.log(data);\r\n    return {\r\n      uid: data.userId,\r\n      title: data.user.username,\r\n      avatar: data.user.avatarLarge,\r\n      type: \"juejin\",\r\n      displayName: \"掘金\",\r\n      raw: data,\r\n      supportTypes: [\"markdown\"],\r\n      home: \"https://juejin.im/editor/drafts\",\r\n      icon: \"https://gold-cdn.xitu.io/favicons/favicon.ico\"\r\n    };\r\n  }\r\n\r\n  async addPost(post, _instance) {\r\n    // https://post-storage-api-ms.juejin.im/v1/draftStorage\r\n    console.log(\"addPost\", _instance);\r\n    console.log(_instance.account, post.markdown);\r\n    // var post_id = res.data.id;\r\n    var res = await $.ajax({\r\n      url: \"https://post-storage-api-ms.juejin.im/v1/draftStorage\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      headers: {\r\n        accept: \"application/json\"\r\n      },\r\n      data: {\r\n        uid: _instance.account.uid,\r\n        device_id: _instance.account.raw.clientId,\r\n        token: _instance.account.raw.token,\r\n        src: \"web\",\r\n        category: \"5562b428e4b00c57d9b94b9d\",\r\n        content: \"\",\r\n        html: post.post_content,\r\n        markdown: post.markdown,\r\n        screenshot: \"\",\r\n        isTitleImageFullscreen: 0,\r\n        tags: \"\",\r\n        title: post.post_title,\r\n        type: \"markdown\"\r\n      }\r\n    });\r\n    console.log(res);\r\n    return {\r\n      status: \"success\",\r\n      post_id: res.d[0]\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    return {\r\n      status: \"success\",\r\n      post_id: post_id,\r\n      draftLink: \"https://juejin.im/editor/drafts/\" + post_id\r\n    };\r\n  }\r\n\r\n  async uploadFile(file) {\r\n    var src = file.src;\r\n    var res = await $.ajax({\r\n      url: \"https://cdn-ms.xitu.io/v1/fetch\",\r\n      type: \"POST\",\r\n      contentType: \"application/json\",\r\n      xhrFields: {\r\n        withCredentials: true\r\n      },\r\n      headers: {\r\n        accept: \"application/json\"\r\n      },\r\n      data: JSON.stringify({\r\n        bucket: \"gold-user-assets\",\r\n        url: \"1\"\r\n      })\r\n    });\r\n\r\n    console.log(res);\r\n\r\n    return [\r\n      // {\r\n      //     id: fileResp.data.pics.pic_1.pid,\r\n      //     object_key: fileResp.data.pics.pic_1.pid,\r\n      //     url: 'https://wx3.sinaimg.cn/large/' + fileResp.data.pics.pic_1.pid + '.jpg'\r\n      // }\r\n    ];\r\n  }\r\n\r\n  async uploadFileByForm($file) {\r\n    var formdata = new FormData();\r\n    formdata.append(\"file\", $file);\r\n    var res = await axios({\r\n      url: \"https://cdn-ms.juejin.im/v1/upload?bucket=gold-user-assets\",\r\n      method: \"post\",\r\n      data: formdata,\r\n      headers: { \"Content-Type\": \"multipart/form-data\" }\r\n    });\r\n\r\n    return res.data.d.url.http;\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = Juejin;\n\r\n\r\n// (async () => {\r\n//     var tester = new WeixinDriver();\r\n//     await tester.getMetaData();\r\n// })();\r\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// https://mp.csdn.net/mdeditor/saveArticle\r\n// title: 996.ICU项目Stars构成分析\r\n// markdowncontent:\r\n// 996.ICU项目Stars构成分析\r\n// content: <p>996.ICU项目Stars构成分析</p>\r\n// id:\r\n// readType: public\r\n// tags:\r\n// status: 2\r\n// categories:\r\n// type:\r\n// original_link:\r\n// authorized_status: undefined\r\n// articleedittype: 1\r\n// Description:\r\n// resource_url:\r\n// csrf_token:\r\n\r\n// https://me.csdn.net/api/user/show\r\n\r\nclass CSDN {\r\n  constructor() {\r\n    this.name = \"csdn\";\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.get(\"https://me.csdn.net/api/user/show\");\r\n    return {\r\n      uid: res.data.csdnid,\r\n      title: res.data.username,\r\n      avatar: res.data.avatarurl,\r\n      type: \"csdn\",\r\n      displayName: \"CSDN\",\r\n      supportTypes: [\"markdown\"],\r\n      home: \"https://mp.csdn.net/\",\r\n      icon: \"https://csdnimg.cn/public/favicon.ico\"\r\n    };\r\n  }\r\n\r\n  async addPost(post) {\r\n    var res = await $.ajax({\r\n      url: \"https://mp.csdn.net/mdeditor/saveArticle\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      headers: {\r\n        accept: \"application/json\"\r\n      },\r\n      data: {\r\n        title: post.post_title,\r\n        markdowncontent: post.markdown,\r\n        content: post.post_content,\r\n        id: \"\",\r\n        readType: \"public\",\r\n        tags: \"\",\r\n        status: 2,\r\n        categories: \"\",\r\n        type: \"\",\r\n        original_link: \"\",\r\n        authorized_status: \"undefined\",\r\n        articleedittype: 1,\r\n        Description: \"\",\r\n        resource_url: \"\",\r\n        csrf_token: \"\"\r\n      }\r\n    });\r\n    console.log(res);\r\n    return {\r\n      status: \"success\",\r\n      post_id: res.data.id\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    return {\r\n      status: \"success\",\r\n      post_id: post_id,\r\n      draftLink: \"https://mp.csdn.net/mdeditor/\" + post_id\r\n    };\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = CSDN;\n\r\n\r\n// (async () => {\r\n//     var tester = new WeixinDriver();\r\n//     await tester.getMetaData();\r\n// })();\r\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// https://mp.csdn.net/mdeditor/saveArticle\r\n// title: 996.ICU项目Stars构成分析\r\n// markdowncontent:\r\n// 996.ICU项目Stars构成分析\r\n// content: <p>996.ICU项目Stars构成分析</p>\r\n// id:\r\n// readType: public\r\n// tags:\r\n// status: 2\r\n// categories:\r\n// type:\r\n// original_link:\r\n// authorized_status: undefined\r\n// articleedittype: 1\r\n// Description:\r\n// resource_url:\r\n// csrf_token:\r\n// https://me.csdn.net/api/user/show\r\n// https://passport.cnblogs.com/user/LoginInfo?callback=jQuery17083998854357229_1570784103705&_=1570784103764\r\n\r\nclass Cnblog {\r\n  constructor() {\r\n    this.name = \"cnblog\";\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.get(\"https://home.cnblogs.com/user/CurrentUserInfo\");\r\n    var parser = new DOMParser();\r\n    var htmlDoc = parser.parseFromString(res, \"text/html\");\r\n    var img = htmlDoc.getElementsByClassName(\"pfs\")[0];\r\n    var link = img.parentNode.href;\r\n    var pie = link.split(\"/\");\r\n    pie.pop();\r\n    var uid = pie.pop();\r\n    console.log(link);\r\n    return {\r\n      uid: uid,\r\n      title: uid,\r\n      avatar: img.src,\r\n      type: \"cnblog\",\r\n      displayName: \"CnBlog\",\r\n      supportTypes: [\"markdown\"],\r\n      home: \"https://i.cnblogs.com/EditArticles.aspx?IsDraft=1\",\r\n      icon: \"https://common.cnblogs.com/favicon.ico\"\r\n    };\r\n  }\r\n\r\n  async addPost(post) {\r\n    var postId = null;\r\n    try {\r\n      var res = await $.ajax({\r\n        url: \"https://i.cnblogs.com/EditArticles.aspx?opt=1\",\r\n        type: \"POST\",\r\n        dataType: \"JSON\",\r\n        headers: {},\r\n        data: {\r\n          __VIEWSTATE: \"\",\r\n          __VIEWSTATEGENERATOR: \"\",\r\n          Editor$Edit$txbTitle: post.post_title,\r\n          Editor$Edit$EditorBody: post.markdown,\r\n          Editor$Edit$Advanced$ckbPublished: \"on\",\r\n          Editor$Edit$Advanced$chkDisplayHomePage: \"on\",\r\n          Editor$Edit$Advanced$chkComments: \"on\",\r\n          Editor$Edit$Advanced$chkMainSyndication: \"on\",\r\n          Editor$Edit$Advanced$txbEntryName: \"\",\r\n          Editor$Edit$Advanced$txbExcerpt: \"\",\r\n          Editor$Edit$Advanced$txbTag: \"\",\r\n          Editor$Edit$Advanced$tbEnryPassword: \"\",\r\n          Editor$Edit$lkbDraft: \"存为草稿\"\r\n        }\r\n      });\r\n      console.log(\"CNBLOG addPost\", res);\r\n    } catch (e) {\r\n      var parser = new DOMParser();\r\n      var htmlDoc = parser.parseFromString(e.responseText, \"text/html\");\r\n      var editLink = htmlDoc.getElementById(\"TipsPanel_LinkEdit\");\r\n      var ErrorPanel = htmlDoc.getElementsByClassName(\"ErrorPanel\")[0];\r\n      if (editLink) {\r\n        postId = editLink.href.split(\"postid=\")[1];\r\n        console.log(\"CNBLOG error\", editLink, editLink.href.query);\r\n      } else {\r\n        if (ErrorPanel) {\r\n          throw Error(ErrorPanel.innerText);\r\n        }\r\n      }\r\n      console.log(\"CNBLOG error\", e.responseText, htmlDoc, editLink);\r\n    }\r\n\r\n    return {\r\n      status: \"success\",\r\n      post_id: postId\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    return {\r\n      status: \"success\",\r\n      post_id: post_id,\r\n      draftLink:\r\n        \"https://i.cnblogs.com/EditArticles.aspx?postid=\" +\r\n        post_id +\r\n        \"&update=1\"\r\n    };\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = Cnblog;\n\r\n\r\n// (async () => {\r\n//     var tester = new WeixinDriver();\r\n//     await tester.getMetaData();\r\n// })();\r\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar weixinMetaCache = null;\r\n\r\n\r\nclass WeixinDriver {\r\n  constructor() {\r\n    this.meta = weixinMetaCache;\r\n    this.name = \"weixin\";\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.ajax({ url: \"https://mp.weixin.qq.com/\" });\r\n    var innerDoc = $(res);\r\n    var doc = $(\"<div>\").append(innerDoc.clone());\r\n    // console.log('WeixinDriver', res);\r\n    var code = doc\r\n      .find(\"script\")\r\n      .eq(0)\r\n      .text();\r\n    code = code.substring(code.indexOf(\"window.wx.commonData\"));\r\n    var wx = new Function(\r\n      \"window.wx = {}; window.handlerNickname = function(){};\" +\r\n        code +\r\n        \"; return window.wx;\"\r\n    )();\r\n    console.log(code, wx);\r\n    var commonData = Object.assign({}, wx.commonData);\r\n    delete window.wx;\r\n    if (!commonData.data.t) {\r\n      throw new Error(\"未登录\");\r\n    }\r\n    var metadata = {\r\n      uid: commonData.data.user_name,\r\n      title: commonData.data.nick_name,\r\n      token: commonData.data.t,\r\n      commonData: commonData,\r\n      avatar: doc\r\n        .find(\".weui-desktop-account__thumb\")\r\n        .eq(0)\r\n        .attr(\"src\"),\r\n      type: \"weixin\",\r\n      supportTypes: [\"html\"],\r\n      home: \"https://mp.weixin.qq.com\",\r\n      icon: \"https://mp.weixin.qq.com/favicon.ico\"\r\n    };\r\n    weixinMetaCache = metadata;\r\n    console.log(\"weixinMetaCache\", weixinMetaCache);\r\n    return metadata;\r\n  }\r\n\r\n  async addPost(post) {\r\n    return {\r\n      status: \"success\",\r\n      post_id: 0\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    console.log(\"editPost\", post.post_thumbnail);\r\n    var res = await $.ajax({\r\n      url:\r\n        \"https://mp.weixin.qq.com/cgi-bin/operate_appmsg?t=ajax-response&sub=create&type=10&token=\" +\r\n        weixinMetaCache.token +\r\n        \"&lang=zh_CN\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      data: {\r\n        token: weixinMetaCache.token,\r\n        lang: \"zh_CN\",\r\n        f: \"json\",\r\n        ajax: \"1\",\r\n        random: Math.random(),\r\n        AppMsgId: \"\",\r\n        count: \"1\",\r\n        data_seq: \"0\",\r\n        operate_from: \"Chrome\",\r\n        isnew: \"0\",\r\n        ad_video_transition0: \"\",\r\n        can_reward0: \"0\",\r\n        related_video0: \"\",\r\n        is_video_recommend0: \"-1\",\r\n        title0: post.post_title,\r\n        author0: \"\",\r\n        writerid0: \"0\",\r\n        fileid0: \"\",\r\n        digest0: post.post_title,\r\n        auto_gen_digest0: \"1\",\r\n        content0: post.post_content,\r\n        sourceurl0: \"\",\r\n        need_open_comment0: \"1\",\r\n        only_fans_can_comment0: \"0\",\r\n        cdn_url0: \"\",\r\n        cdn_235_1_url0: \"\",\r\n        cdn_1_1_url0: \"\",\r\n        cdn_url_back0: \"\",\r\n        crop_list0: \"\",\r\n        music_id0: \"\",\r\n        video_id0: \"\",\r\n        voteid0: \"\",\r\n        voteismlt0: \"\",\r\n        supervoteid0: \"\",\r\n        cardid0: \"\",\r\n        cardquantity0: \"\",\r\n        cardlimit0: \"\",\r\n        vid_type0: \"\",\r\n        show_cover_pic0: \"0\",\r\n        shortvideofileid0: \"\",\r\n        copyright_type0: \"0\",\r\n        releasefirst0: \"\",\r\n        platform0: \"\",\r\n        reprint_permit_type0: \"\",\r\n        allow_reprint0: \"\",\r\n        allow_reprint_modify0: \"\",\r\n        original_article_type0: \"\",\r\n        ori_white_list0: \"\",\r\n        free_content0: \"\",\r\n        fee0: \"0\",\r\n        ad_id0: \"\",\r\n        guide_words0: \"\",\r\n        is_share_copyright0: \"0\",\r\n        share_copyright_url0: \"\",\r\n        source_article_type0: \"\",\r\n        reprint_recommend_title0: \"\",\r\n        reprint_recommend_content0: \"\",\r\n        share_page_type0: \"0\",\r\n        share_imageinfo0: '{\"list\":[]}',\r\n        share_video_id0: \"\",\r\n        dot0: \"{}\",\r\n        share_voice_id0: \"\",\r\n        insert_ad_mode0: \"\",\r\n        categories_list0: \"[]\",\r\n        sections0:\r\n          '[{\"section_index\":1000000,\"text_content\":\"​kkk\",\"section_type\":9,\"ad_available\":false}]',\r\n        compose_info0:\r\n          '{\"list\":[{\"blockIdx\":1,\"content\":\"<p>​kkk<br></p>\",\"width\":574,\"height\":27,\"topMargin\":0,\"blockType\":9,\"background\":\"rgba(0, 0, 0, 0)\",\"text\":\"kkk\",\"textColor\":\"rgb(51, 51, 51)\",\"textFontSize\":\"17px\",\"textBackGround\":\"rgba(0, 0, 0, 0)\"}]}'\r\n      }\r\n    });\r\n\r\n    if (!res.appMsgId) {\r\n      var err = formatError(res);\r\n      console.log(\"error\", err);\r\n      throw new Error(\r\n        \"同步失败 错误内容：\" + (err && err.errmsg ? err.errmsg : res.ret)\r\n      );\r\n    }\r\n    return {\r\n      status: \"success\",\r\n      post_id: res.appMsgId,\r\n      draftLink:\r\n        \"https://mp.weixin.qq.com/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=10&appmsgid=\" +\r\n        res.appMsgId +\r\n        \"&token=\" +\r\n        weixinMetaCache.token +\r\n        \"&lang=zh_CN\"\r\n    };\r\n    // https://zhuanlan.zhihu.com/api/articles/68769713/draft\r\n  }\r\n\r\n  async uploadFile(file) {\r\n    var src = file.src;\r\n    var res = await $.ajax({\r\n      url:\r\n        \"https://mp.weixin.qq.com/cgi-bin/uploadimg2cdn?lang=zh_CN&token=\" +\r\n        weixinMetaCache.token +\r\n        \"&t=\" +\r\n        Math.random(),\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      data: {\r\n        imgurl: src,\r\n        t: \"ajax-editor-upload-img\",\r\n        token: weixinMetaCache.token,\r\n        lang: \"zh_CN\",\r\n        f: \"json\",\r\n        ajax: \"1\"\r\n      }\r\n    });\r\n\r\n    if (res.errcode != 0) {\r\n      throw new Error(\"图片上传失败\" + src);\r\n    }\r\n    console.log(res);\r\n    return [\r\n      {\r\n        id: \"aaa\",\r\n        object_key: \"aaa\",\r\n        url: res.url\r\n      }\r\n    ];\r\n  }\r\n\r\n  async preEditPost(post) {\r\n    var div = $(\"<div>\");\r\n    $(\"body\").append(div);\r\n\r\n    if (post.inline_content) {\r\n      post.content = post.inline_content;\r\n    }\r\n\r\n    div.html(post.content);\r\n\r\n    var doc = div;\r\n    var tags = doc.find(\"p\");\r\n    for (let mindex = 0; mindex < tags.length; mindex++) {\r\n      const tag = tags.eq(mindex);\r\n      try {\r\n        var nextHasImage = tag.next().children(\"img\").length;\r\n        var span = $(\"<span></span>\");\r\n        span.html(tag.html());\r\n        tag.html(\"\");\r\n        tag.append(span);\r\n        // if (!tag.children(\"br\").length) tag.css(\"margin-bottom\", \"20px\");\r\n        // tag.after(\"<p><br></p>\");\r\n        // span.css(\"color\", \"rgb(68, 68, 68)\");\r\n        // span.css(\"font-size\", \"16px\");\r\n      } catch (e) {}\r\n    }\r\n\r\n    var tags = doc.find(\"img\");\r\n    for (let mindex = 0; mindex < tags.length; mindex++) {\r\n      const tag = tags.eq(mindex);\r\n      const wraperTag = tag.parent();\r\n      try {\r\n        tag.removeAttr(\"_src\");\r\n        tag.attr(\"style\", \"\");\r\n        wraperTag.replaceWith(\"<p>\" + wraperTag.html() + \"</p>\");\r\n      } catch (e) {}\r\n    }\r\n\r\n    var pres = doc.find(\"a\");\r\n    for (let mindex = 0; mindex < pres.length; mindex++) {\r\n      const pre = pres.eq(mindex);\r\n      try {\r\n        pre.after(pre.html()).remove();\r\n      } catch (e) {}\r\n    }\r\n\r\n    var processEmptyLine = function(idx, el) {\r\n      var $obj = $(this);\r\n      var originalText = $obj.text();\r\n      var img = $obj.find(\"img\");\r\n      var brs = $obj.find(\"br\");\r\n      if (originalText == \"\") {\r\n        (function() {\r\n          if (img.length) return;\r\n          if (!brs.length) return;\r\n          $obj.remove();\r\n        })();\r\n      }\r\n    };\r\n\r\n    var processListItem = function(idx, el) {\r\n      var $obj = $(this);\r\n      $obj.html($(\"<p></p>\").append($obj.html()));\r\n    };\r\n\r\n    doc.find(\"li\").each(processListItem);\r\n    // remove empty break line\r\n    doc.find(\"p\").each(processEmptyLine);\r\n\r\n    var processBr = function(idx, el) {\r\n      var $obj = $(this);\r\n      if (!$obj.next().length) {\r\n        $obj.remove();\r\n      }\r\n    };\r\n\r\n    doc.find(\"br\").each(processBr);\r\n    post.content = $(\"<div>\")\r\n      .append(\r\n        \"<section style='margin-left: 6px;margin-right: 6px;line-height: 1.75em;'>\" +\r\n          doc.clone().html() +\r\n          \"</section>\"\r\n      )\r\n      .html();\r\n\r\n    console.log(\"post.content\", post.content);\r\n    var inlineCssHTML = juice.inlineContent(\r\n      post.content,\r\n      `\r\n    /**\r\n    * common style\r\n    */\r\n\r\n   html, address,\r\n   blockquote,\r\n   body, dd, div,\r\n   dl, dt, fieldset, form,\r\n   frame, frameset,\r\n   h1, h2, h3, h4,\r\n   h5, h6, noframes,\r\n   ol, p, ul, center,\r\n   dir, hr, menu, pre   { display: block; unicode-bidi: embed }\r\n   li              { display: list-item }\r\n   head            { display: none }\r\n   table           { display: table }\r\n   tr              { display: table-row }\r\n   thead           { display: table-header-group }\r\n   tbody           { display: table-row-group }\r\n   tfoot           { display: table-footer-group }\r\n   col             { display: table-column }\r\n   colgroup        { display: table-column-group }\r\n   td, th          { display: table-cell }\r\n   caption         { display: table-caption }\r\n   th              { font-weight: bolder; text-align: center }\r\n   caption         { text-align: center }\r\n   body            { margin: 8px }\r\n   h1              { font-size: 2em; margin: .67em 0 }\r\n   h2              { font-size: 1.5em; margin: .75em 0 }\r\n   h3              { font-size: 1.17em; margin: .83em 0 }\r\n   h4, p,\r\n   blockquote, ul,\r\n   fieldset, form,\r\n   ol, dl, dir,\r\n   menu            { margin: 1.12em 0 }\r\n   h5              { font-size: .83em; margin: 1.5em 0 }\r\n   h6              { font-size: .75em; margin: 1.67em 0 }\r\n   h1, h2, h3, h4,\r\n   h5, h6, b,\r\n   strong          { font-weight: bolder }\r\n   blockquote      { margin-left: 40px; margin-right: 40px }\r\n   i, cite, em,\r\n   var, address    { font-style: italic }\r\n   pre, tt, code,\r\n   kbd, samp       { font-family: monospace }\r\n   pre             { white-space: pre }\r\n   button, textarea,\r\n   input, select   { display: inline-block }\r\n   big             { font-size: 1.17em }\r\n   small, sub, sup { font-size: .83em }\r\n   sub             { vertical-align: sub }\r\n   sup             { vertical-align: super }\r\n   table           { border-spacing: 2px; }\r\n   thead, tbody,\r\n   tfoot           { vertical-align: middle }\r\n   td, th, tr      { vertical-align: inherit }\r\n   s, strike, del  { text-decoration: line-through }\r\n   hr              { border: 1px inset }\r\n   ol, ul, dir,\r\n   menu, dd        { margin-left: 40px }\r\n   ol              { list-style-type: decimal }\r\n   ol ul, ul ol,\r\n   ul ul, ol ol    { margin-top: 0; margin-bottom: 0 }\r\n   u, ins          { text-decoration: underline }\r\n   br:before       { content: \"\\A\"; white-space: pre-line }\r\n   center          { text-align: center }\r\n   :link, :visited { text-decoration: underline }\r\n   :focus          { outline: thin dotted invert }\r\n   \r\n   /* Begin bidirectionality settings (do not change) */\r\n   BDO[DIR=\"ltr\"]  { direction: ltr; unicode-bidi: bidi-override }\r\n   BDO[DIR=\"rtl\"]  { direction: rtl; unicode-bidi: bidi-override }\r\n   \r\n   *[DIR=\"ltr\"]    { direction: ltr; unicode-bidi: embed }\r\n   *[DIR=\"rtl\"]    { direction: rtl; unicode-bidi: embed }\r\n   \r\n   @media print {\r\n     h1            { page-break-before: always }\r\n     h1, h2, h3,\r\n     h4, h5, h6    { page-break-after: avoid }\r\n     ul, ol, dl    { page-break-before: avoid }\r\n   }\r\n   h1,\r\n   h2,\r\n   h3,\r\n   h4,\r\n   h5,\r\n   h6 {\r\n     font-weight: bold;\r\n   }\r\n   \r\n   h1 {\r\n     font-size: 1.25em;\r\n     line-height: 1.4em;\r\n   }\r\n   \r\n   h2 {\r\n     font-size: 1.125em;\r\n   }\r\n   \r\n   h3 {\r\n     font-size: 1.05em;\r\n   }\r\n   \r\n   h4,\r\n   h5,\r\n   h6 {\r\n     font-size: 1em;\r\n     margin: 1em 0;\r\n   }\r\n\r\n    p {\r\n      color: rgb(51, 51, 51);\r\n      font-size: 15px;\r\n    }\r\n\r\n    li p {\r\n      margin: 0;\r\n    }\r\n   `\r\n    );\r\n    console.log(\"inlineCssHTML new\", inlineCssHTML);\r\n    post.content = inlineCssHTML;\r\n  }\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = WeixinDriver;\n\r\n\r\nfunction formatError(e) {\r\n  var r,\r\n    a = {\r\n      errmsg: \"\",\r\n      index: !1\r\n    };\r\n  switch (\r\n    (\"undefined\" != typeof e.ret\r\n      ? (r = 1 * e.ret)\r\n      : e.base_resp &&\r\n        \"undefined\" != typeof e.base_resp.ret &&\r\n        (r = 1 * e.base_resp.ret),\r\n    1 * r)\r\n  ) {\r\n    case -8:\r\n    case -6:\r\n      (e.ret = \"-6\"), (a.errmsg = \"请输入验证码\");\r\n      break;\r\n\r\n    case 62752:\r\n      a.errmsg = \"可能含有具备安全风险的链接，请检查\";\r\n      break;\r\n\r\n    case 64505:\r\n      a.errmsg = \"发送预览失败，请稍后再试\";\r\n      break;\r\n\r\n    case 64504:\r\n      a.errmsg = \"保存图文消息发送错误，请稍后再试\";\r\n      break;\r\n\r\n    case 64518:\r\n      a.errmsg = \"正文只能包含一个投票\";\r\n      break;\r\n\r\n    case 10704:\r\n    case 10705:\r\n      a.errmsg = \"该素材已被删除\";\r\n      break;\r\n\r\n    case 10701:\r\n      a.errmsg = \"用户已被加入黑名单，无法向其发送消息\";\r\n      break;\r\n\r\n    case 10703:\r\n      a.errmsg = \"对方关闭了接收消息\";\r\n      break;\r\n\r\n    case 10700:\r\n    case 64503:\r\n      a.errmsg =\r\n        \"1.接收预览消息的微信尚未关注公众号，请先扫码关注<br /> 2.如果已经关注公众号，请查看微信的隐私设置（在手机微信的“我->设置->隐私->添加我的方式”中），并开启“可通过以下方式找到我”的“手机号”、“微信号”、“QQ号”，否则可能接收不到预览消息\";\r\n      break;\r\n\r\n    case 64502:\r\n      a.errmsg = \"你输入的微信号不存在，请重新输入\";\r\n      break;\r\n\r\n    case 64501:\r\n      a.errmsg = \"你输入的帐号不存在，请重新输入\";\r\n      break;\r\n\r\n    case 412:\r\n      a.errmsg = \"图文中含非法外链\";\r\n      break;\r\n\r\n    case 64515:\r\n      a.errmsg = \"当前素材非最新内容，请重新打开并编辑\";\r\n      break;\r\n\r\n    case 320001:\r\n      a.errmsg = \"该素材已被删除，无法保存\";\r\n      break;\r\n\r\n    case 64702:\r\n      a.errmsg = \"标题超出64字长度限制\";\r\n      break;\r\n\r\n    case 64703:\r\n      a.errmsg = \"摘要超出120字长度限制\";\r\n      break;\r\n\r\n    case 64704:\r\n      a.errmsg = \"推荐语超出300字长度限制\";\r\n      break;\r\n\r\n    case 64708:\r\n      a.errmsg = \"推荐语超出140字长度限制\";\r\n      break;\r\n\r\n    case 64515:\r\n      a.errmsg = \"当前素材非最新内容\";\r\n      break;\r\n\r\n    case 200041:\r\n      a.errmsg = \"此素材有文章存在违规，无法编辑\";\r\n      break;\r\n\r\n    case 64506:\r\n      a.errmsg = \"保存失败,链接不合法\";\r\n      break;\r\n\r\n    case 64507:\r\n      a.errmsg =\r\n        \"内容不能包含外部链接，请输入http://或https://开头的公众号相关链接\";\r\n      break;\r\n\r\n    case 64510:\r\n      a.errmsg = \"内容不能包含音频，请调整\";\r\n      break;\r\n\r\n    case 64511:\r\n      a.errmsg = \"内容不能包多个音频，请调整\";\r\n      break;\r\n\r\n    case 64512:\r\n      a.errmsg = \"文章中音频错误,请使用音频添加按钮重新添加。\";\r\n      break;\r\n\r\n    case 64508:\r\n      a.errmsg = \"查看原文链接可能具备安全风险，请检查\";\r\n      break;\r\n\r\n    case 64550:\r\n      a.errmsg = \"请勿插入不合法的图文消息链接\";\r\n      break;\r\n\r\n    case 64558:\r\n      a.errmsg = \"请勿插入图文消息临时链接，链接会在短期失效\";\r\n      break;\r\n\r\n    case 64559:\r\n      a.errmsg = \"请勿插入未群发的图文消息链接\";\r\n      break;\r\n\r\n    case -99:\r\n      a.errmsg = \"内容超出字数，请调整\";\r\n      break;\r\n\r\n    case 64705:\r\n      a.errmsg = \"内容超出字数，请调整\";\r\n      break;\r\n\r\n    case -1:\r\n      a.errmsg = \"系统错误，请注意备份内容后重试\";\r\n      break;\r\n\r\n    case -2:\r\n    case 200002:\r\n      a.errmsg = \"参数错误，请注意备份内容后重试\";\r\n      break;\r\n\r\n    case 64509:\r\n      a.errmsg = \"正文中不能包含超过3个视频，请重新编辑正文后再保存。\";\r\n      break;\r\n\r\n    case -5:\r\n      a.errmsg = \"服务错误，请注意备份内容后重试。\";\r\n      break;\r\n\r\n    case 64513:\r\n      a.errmsg = \"请从正文中选择封面，再尝试保存。\";\r\n      break;\r\n\r\n    case -206:\r\n      a.errmsg = \"目前，服务负荷过大，请稍后重试。\";\r\n      break;\r\n\r\n    case 10801:\r\n      (a.errmsg =\r\n        \"标题不能有违反公众平台协议、相关法律法规和政策的内容，请重新编辑。\"),\r\n        (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 10802:\r\n      (a.errmsg =\r\n        \"作者不能有违反公众平台协议、相关法律法规和政策的内容，请重新编辑。\"),\r\n        (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 10803:\r\n      (a.errmsg = \"敏感链接，请重新添加。\"), (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 10804:\r\n      (a.errmsg =\r\n        \"摘要不能有违反公众平台协议、相关法律法规和政策的内容，请重新编辑。\"),\r\n        (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 10806:\r\n      (a.errmsg =\r\n        \"正文不能有违反公众平台协议、相关法律法规和政策的内容，请重新编辑。\"),\r\n        (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 10808:\r\n      (a.errmsg =\r\n        \"推荐语不能有违反公众平台协议、相关法律法规和政策的内容，请重新编辑。\"),\r\n        (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 10807:\r\n      a.errmsg = \"内容不能违反公众平台协议、相关法律法规和政策，请重新编辑。\";\r\n      break;\r\n\r\n    case 200003:\r\n      a.errmsg = \"登录态超时，请重新登录。\";\r\n      break;\r\n\r\n    case 64513:\r\n      a.errmsg = \"封面必须存在正文中，请检查封面\";\r\n      break;\r\n\r\n    case 64551:\r\n      a.errmsg = \"请检查图文消息中的微视链接后重试。\";\r\n      break;\r\n\r\n    case 64552:\r\n      a.errmsg = \"请检查阅读原文中的链接后重试。\";\r\n      break;\r\n\r\n    case 64553:\r\n      a.errmsg = \"请不要在图文消息中插入超过5张卡券。请删减卡券后重试。\";\r\n      break;\r\n\r\n    case 64554:\r\n      a.errmsg = \"在当前情况下不允许在图文消息中插入卡券，请删除卡券后重试。\";\r\n      break;\r\n\r\n    case 64555:\r\n      a.errmsg = \"请检查图文消息卡片跳转的链接后重试。\";\r\n      break;\r\n\r\n    case 64556:\r\n      a.errmsg = \"卡券不属于该公众号，请删除后重试\";\r\n      break;\r\n\r\n    case 64557:\r\n      a.errmsg = \"卡券无效，请删除后重试。\";\r\n      break;\r\n\r\n    case 13002:\r\n      (a.errmsg = \"该广告卡片已过期，删除后才可保存成功\"),\r\n        (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 13003:\r\n      (a.errmsg = \"已有文章插入过该广告卡片，一个广告卡片仅可插入一篇文章\"),\r\n        (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 13004:\r\n      (a.errmsg = \"该广告卡片与图文消息位置不一致\"), (a.index = 1 * e.msg);\r\n      break;\r\n\r\n    case 15801:\r\n    case 15802:\r\n    case 15803:\r\n    case 15804:\r\n    case 15805:\r\n    case 15806:\r\n      a.errmsg =\r\n        e.remind_wording ||\r\n        \"你所编辑的内容可能含有违反微信公众平台平台协议、相关法律法规和政策的内容\";\r\n      break;\r\n\r\n    case 1530503:\r\n      a.errmsg = \"请勿添加其他公众号的主页链接\";\r\n      break;\r\n\r\n    case 1530504:\r\n      a.errmsg = \"请勿添加其他公众号的主页链接\";\r\n      break;\r\n\r\n    case 1530510:\r\n      a.errmsg = \"链接已失效，请在手机端重新复制链接\";\r\n      break;\r\n\r\n    case 153007:\r\n    case 153008:\r\n    case 153009:\r\n    case 153010:\r\n      a.errmsg =\r\n        \"很抱歉，原创声明不成功|你的文章内容未达到声明原创的要求，满足以下任一条件可发起声明：<br />1、文章文字字数大于300字，且自己创作的内容大于引用内容<br />2、文章文字字数小于300字，无视频，且图片（包括封面图）均为你已成功声明原创的图片<br />说明：上述要求中，文章文字字数不包含标点符号和空格，请知悉。\";\r\n      break;\r\n\r\n    case 153200:\r\n      a.errmsg = \"无权限声明原创，取消声明后重试\";\r\n      break;\r\n\r\n    case 1530511:\r\n      a.errmsg = \"链接已失效，请在手机端重新复制链接\";\r\n      break;\r\n\r\n    case 220001:\r\n      a.errmsg = '\"素材管理\"中的存储数量已达到上限，请删除后再操作。';\r\n      break;\r\n\r\n    case 220002:\r\n      a.errmsg = \"你的图片库已达到存储上限，请进行清理。\";\r\n      break;\r\n\r\n    case 153012:\r\n      a.errmsg = \"请设置转载类型\";\r\n      break;\r\n\r\n    case 200042:\r\n      a.errmsg = \"图文中包含的小程序素材不能多于50个、小程序帐号不能多于10个\";\r\n      break;\r\n\r\n    case 200043:\r\n      a.errmsg = \"图文中包含没有关联的小程序，请删除后再保存\";\r\n      break;\r\n\r\n    case 64601:\r\n      a.errmsg = \"一篇文章只能插入一个广告卡片\";\r\n      break;\r\n\r\n    case 64602:\r\n      a.errmsg = \"尚未开通文中广告位，但文章中有广告\";\r\n      break;\r\n\r\n    case 64603:\r\n      a.errmsg = \"文中广告前不足300字\";\r\n      break;\r\n\r\n    case 64604:\r\n      a.errmsg = \"文中广告后不足300字\";\r\n      break;\r\n\r\n    case 64605:\r\n      a.errmsg = \"文中不能同时插入文中广告和互选广告\";\r\n      break;\r\n\r\n    case 65101:\r\n      a.errmsg = \"图文模版数量已达到上限，请删除后再操作\";\r\n      break;\r\n\r\n    case 64560:\r\n      a.errmsg = \"请勿插入历史图文消息页链接\";\r\n      break;\r\n\r\n    case 64561:\r\n      a.errmsg = \"请勿插入mp.weixin.qq.com域名下的非图文消息链接\";\r\n      break;\r\n\r\n    case 64562:\r\n      a.errmsg = \"请勿插入非mp.weixin.qq.com域名的链接\";\r\n      break;\r\n\r\n    case 153013:\r\n      a.errmsg = \"文章内含有投票，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153014:\r\n      a.errmsg = \"文章内含有卡券，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153015:\r\n      a.errmsg = \"文章内含有小程序链接，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153016:\r\n      a.errmsg = \"文章内含有小程序链接，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153017:\r\n      a.errmsg = \"文章内含有小程序卡片，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153018:\r\n      a.errmsg = \"文章内含有商品，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153019:\r\n      a.errmsg = \"文章内含有广告卡片，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153020:\r\n      a.errmsg = \"文章内含有广告卡片，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153021:\r\n      a.errmsg = \"文章内含有广告卡片，不能设置为开放转载\";\r\n      break;\r\n\r\n    case 153101:\r\n      a.errmsg = \"含有原文已删除的转载文章，请删除后重试\";\r\n      break;\r\n\r\n    case 64707:\r\n      a.errmsg = \"赞赏账户授权失效或者状态异常\";\r\n      break;\r\n\r\n    case 420001:\r\n      a.errmsg = \"封面图不支持GIF，请更换\";\r\n      break;\r\n\r\n    case 353004:\r\n      a.errmsg = \"不支持添加商品，请删除后重试\";\r\n      break;\r\n\r\n    case 442001:\r\n      a.errmsg = \"帐号新建/编辑素材能力已被封禁，暂不可使用。\";\r\n      break;\r\n\r\n    default:\r\n      a.errmsg = \"系统繁忙，请稍后重试\";\r\n  }\r\n  return a;\r\n}\r\n\r\n// (async () => {\r\n//     var tester = new WeixinDriver();\r\n//     await tester.getMetaData();\r\n// })();\r\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nclass YiDian {\r\n  constructor() {\r\n    this.skipReadImage = true;\r\n  }\r\n\r\n  async getMetaData() {\r\n    var res = await $.ajax({ url: \"https://mp.yidianzixun.com\" });\r\n    var innerDoc = $(res);\r\n    var doc = $(\"<div>\").append(innerDoc.clone());\r\n    var code = doc\r\n      .find(\"#__val_\")\r\n      .text();\r\n    console.log('YiDian', code)\r\n    // code = code.substring(code.indexOf(\"window.mpuser\"));\r\n    // eval(code);\r\n    var mpuser = new Function(\r\n        code +\r\n        \"; return window.mpuser;\"\r\n    )();\r\n    var commonData = Object.assign({}, mpuser);\r\n    console.log(commonData);\r\n    if (!commonData.id) {\r\n      throw new Error(\"未登录\");\r\n    }\r\n    var metadata = {\r\n      uid: commonData.id,\r\n      title: commonData.media_name,\r\n      commonData: commonData,\r\n      avatar: commonData.media_pic,\r\n      type: \"yidian\",\r\n      supportTypes: [\"html\"],\r\n      home: \"https://mp.yidianzixun.com\",\r\n      icon: \"https://www.yidianzixun.com/favicon.ico\"\r\n    };\r\n    return metadata;\r\n  }\r\n\r\n  async addPost(post) {\r\n    return {\r\n      status: \"success\",\r\n      post_id: 0\r\n    };\r\n  }\r\n\r\n  async editPost(post_id, post) {\r\n    var res = await $.ajax({\r\n      url: \"https://mp.yidianzixun.com/model/Article\",\r\n      type: \"POST\",\r\n      dataType: \"JSON\",\r\n      data: {\r\n        title: post.post_title,\r\n        cate: \"\",\r\n        cateB: \"\",\r\n        coverType: \"default\",\r\n        covers: [],\r\n        content: post.post_content,\r\n        hasSubTitle: 0,\r\n        subTitle: \"\",\r\n        original: 0,\r\n        reward: 0,\r\n        videos: [],\r\n        audios: [],\r\n        votes: {\r\n          vote_id: \"\",\r\n          vote_options: [],\r\n          vote_end_time: \"\",\r\n          vote_title: \"\",\r\n          vote_type: 1,\r\n          isAdded: false\r\n        },\r\n        images: [],\r\n        goods: [],\r\n        is_mobile: 0,\r\n        status: 0,\r\n        import_url: \"\",\r\n        import_hash: \"\",\r\n        image_urls: {},\r\n        minTimingHour: 3,\r\n        maxTimingDay: 7,\r\n        tags: [],\r\n        isPubed: false,\r\n        lastSaveTime: \"\",\r\n        dirty: false,\r\n        editorType: \"articleEditor\",\r\n        activity_id: 0,\r\n        join_activity: 0,\r\n        notSaveToStore: true\r\n      }\r\n    });\r\n\r\n    if (!res.id) {\r\n      throw new Error('同步错误'+ JSON.stringify(res));\r\n    }\r\n    return {\r\n      status: \"success\",\r\n      post_id: res.id,\r\n      draftLink:\r\n        \"https://mp.yidianzixun.com/#/Writing/\" + res.id\r\n    };\r\n  }\r\n\r\n  async uploadFile(file) {\r\n    var src = file.src;\r\n    var res = await $.get(\r\n      \"https://mp.yidianzixun.com/api/getImageFromUrl?src=\" +\r\n        encodeURIComponent(src)\r\n    );\r\n    // throw new Error('fuck');\r\n    if (res.status != \"success\") {\r\n      throw new Error(\"图片上传失败 \" + src);\r\n    }\r\n    // http only\r\n    console.log(\"uploadFile\", res);\r\n    return [\r\n      {\r\n        id: \"\",\r\n        object_key: \"\",\r\n        url: res.inner_addr\r\n      }\r\n    ];\r\n  }\r\n\r\n  async preEditPost(post) {\r\n    // var div = $(\"<div>\");\r\n    // $(\"body\").append(div);\r\n    // div.html(post.content);\r\n    // // var org = $(post.content);\r\n    // // var doc = $('<div>').append(org.clone());\r\n    // var doc = div;\r\n    // var pres = doc.find(\"a\");\r\n    // for (let mindex = 0; mindex < pres.length; mindex++) {\r\n    //   const pre = pres.eq(mindex);\r\n    //   try {\r\n    //     pre.after(pre.html()).remove();\r\n    //   } catch (e) {}\r\n    // }\r\n    // var pres = doc.find(\"iframe\");\r\n    // for (let mindex = 0; mindex < pres.length; mindex++) {\r\n    //   const pre = pres.eq(mindex);\r\n    //   try {\r\n    //     pre.remove();\r\n    //   } catch (e) {}\r\n    // }\r\n    // post.content = $(\"<div>\")\r\n    //   .append(doc.clone())\r\n    //   .html();\r\n    // console.log(\"post\", post);\r\n  }\r\n\r\n  //   editImg(img, source) {\r\n  //     img.attr(\"web_uri\", source.images[0].origin_web_uri);\r\n  //   }\r\n  //   <img class=\"\" src=\"http://p2.pstatp.com/large/pgc-image/bc0a9fc8e595453083d85deb947c3d6e\" data-ic=\"false\" data-ic-uri=\"\" data-height=\"1333\" data-width=\"1000\" image_type=\"1\" web_uri=\"pgc-image/bc0a9fc8e595453083d85deb947c3d6e\" img_width=\"1000\" img_height=\"1333\"></img>\r\n}\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = YiDian;\n\r\n\n\n/***/ })\n/******/ ]);for (var k in modules) exports[k] = modules[k];"