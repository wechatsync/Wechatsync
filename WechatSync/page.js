!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=884)}({884:function(e,t){function n(e){0==$("#syncd-pannel").length&&$("body").append('\n<div id="syncd-pannel" style="background:#111;position: fixed;\nuser-select: none;\nbottom: 30px;\nright: 12px;\nleft: initial;\nwidth: 306px;\nheight: 45px;\nborder: 0px;\nz-index: 2147483646;\nclip: auto;\ncolor: white;\nfont-size: 14px;\ndisplay: none;">\n<div>\n  <div style="position: absolute;\n  left: 10px;\n  width: 240px;\n  height: 20px;\n  line-height: 20px;\n  text-align:left;\n  overflow: hidden;\n  cursor: pointer;\n  top: 12px;" id="syncd-title">正在查找文章...</div>\n  <div id="closebtn" style="position: absolute;\n  cursor: pointer;\n  right: 10px;\n  top: 10px;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#f4f4f4" xmlns:xlink="http://www.w3.org/1999/xlink">\n  <path d="M5.69999 5L5 5.70004L11.3 12.0001L5 18.3L5.69999 19L12 12.7L18.3 19L19 18.3L12.7 12.0001L19 5.70004L18.3 5.00012L12 11.3L5.69999 5Z"></path>\n</svg></div>\n</div>\n</div>\n'),$("#closebtn").click(function(){$("#syncd-pannel").remove()});var t=chrome.runtime.getURL("view.html"),n=navigator.userAgent.match(/Chrome\/(\d+)/),i=n&&parseInt(n[1],10)||0;if($(".wechatsync-viewer").length)o=$(".wechatsync-viewer"),r=$(".wechatsync-viewer iframe");else{console.log("add viwer");var r,o,a=document.createElement("div"),c=a.createShadowRoot?a.createShadowRoot():a.webkitCreateShadowRoot?a.webkitCreateShadowRoot():a,s=document.createElement(i>=37?"dialog":"div");(r=$('<iframe src="'+t+'" name="'+window.location.href+'"></iframe>')).css({width:"100%",height:"100%",border:"none"}),$(s).css({position:"fixed",width:"100%",height:"100%",top:0,left:0,background:"rgb(251, 251, 251)",zIndex:"2147483647",display:"block",padding:0,border:"none",margin:0}).append(r),(o=$(s)).css("display","none"),$(c).append($(s)),$("body").append(o),$(s).addClass("wechatsync-viewer")}function l(){!function(){var e=$(ReaderArticleFinderJS.adoptableArticle().outerHTML);function t(e){if(!e)return null;var t=e.src,n=$(e);return n.attr("data-src")&&(t=n.attr("data-src")),t.indexOf("data:image")>-1&&(t=null),t}e.find("a").each(function(e,t){t.setAttribute("href",t.href),""!=t.target&&"_self"!=t.target.toLowerCase()||t.setAttribute("target","_top")}),e.find("img").each(function(e,t){console.log("img.src",t.src,t),t.setAttribute("src",t.src);var n=t.getAttribute("src");n?n.indexOf("data:image/svg+xml")>-1&&null!=t.getAttribute("data-actualsrc")&&t.setAttribute("src",t.getAttribute("data-actualsrc")):(null!=t.getAttribute("data-actualsrc")&&t.setAttribute("src",t.getAttribute("data-actualsrc")),null!=t.getAttribute("_src")&&(console.log("use _src"),t.setAttribute("src",t.getAttribute("_src")))),console.log("after",t)});var n={article:e[0].outerHTML,url:window.location.href,leadingImage:t(ReaderArticleFinderJS.leadingImage),mainImage:t(ReaderArticleFinderJS.mainImageNode()),pageNumber:ReaderArticleFinderJS.pageNumber,description:ReaderArticleFinderJS.pageDescription(),nextPage:ReaderArticleFinderJS.nextPageURL(),title:ReaderArticleFinderJS.articleTitle(),rtl:!ReaderArticleFinderJS.articleIsLTR()};console.log("",r,r[0],ReaderArticleFinderJS.adoptableArticle(),n),r[0].contentWindow.postMessage(JSON.stringify(n),"*")}(),o.css("display","block"),r[0].contentWindow.postMessage(JSON.stringify({method:"openPannel"}),"*")}function d(e,t){var n=0,i=setInterval(function(){if(n>20)return e&&e(),clearInterval(i);ReaderArticleFinderJS.isReaderModeAvailable()&&(clearInterval(i),t&&t()),n++},1e3)}if($("#syncd-title").click(function(){l()}),e)if(ReaderArticleFinderJS.isReaderModeAvailable())d(function(){},function(){l()});else{const e=$("article");if(e.length){setTimeout(()=>{!function(){var t={article:e[0].outerHTML,url:window.location.href,leadingImage:e.find("img").attr("src"),mainImage:e.find("img").attr("src"),pageNumber:1,description:$("meta[name=description]").attr("content"),nextPage:0,title:document.title,rtl:!1};console.log("",r,r[0],t),r[0].contentWindow.postMessage(JSON.stringify(t),"*"),o.css("display","block"),r[0].contentWindow.postMessage(JSON.stringify({method:"openPannel"}),"*")}()},1e3)}else alert("无法识别到文章")}else $("#syncd-pannel").show(),d(function(){$("#syncd-title").html("未找到"),setTimeout(function(){$("#syncd-pannel").remove()},2e3)},function(){$("#syncd-title").html(ReaderArticleFinderJS.articleTitle())});window.addEventListener("message",function(e){try{"closeMe"==JSON.parse(e.data).method&&o.css("display","none")}catch(e){}}),chrome.runtime.onMessage.addListener(function(e,t,n){console.log("page.js revice",e),r[0].contentWindow.postMessage(JSON.stringify(e),"*")})}console.log("page.js",ReaderArticleFinderJS,"Mercury"),window.location.href.indexOf("mp.weixin.qq.com/cgi-bin/appmsg")>-1&&window.addEventListener("message",function(e){try{"GoTemplateCenter"==JSON.parse(e.data).method&&window.open(chrome.runtime.getURL("templates.html"))}catch(e){console.log("page listner",e)}});var i={fetchArticle:function(e,t,i){n(!0)}};chrome.extension.onRequest.addListener(function(e,t,n){e.method&&i[e.method](e,t,n)})}});